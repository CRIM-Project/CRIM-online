{% extends 'base.html' %}

{% load static %}

{% block header %}
<link rel="stylesheet" href="{% static 'css/forum.css' %}">
{% endblock %}

{% block wrap %}
<div id="forum-post">
<h1>{{ post.title }}</h1>
<p>{{ post.text }}</p>
<p>
  Created at {{ post.created_at|time:"h:i A" }} on {{ post.created_at|date:"F d, Y" }} by {{ post.user|default_if_none:"[deleted]" }}</p>
</div>

<div id="comment-form">
<form action="{% url 'create_forum_comment' post.pk %}" method="POST">
  {% csrf_token %}
  <textarea name="body"></textarea>
  <input type="submit" value="Reply" disabled>
</form>
</div>

<div id="comment-tree">
{% autoescape off %}
{{ comment_tree }}
{% endautoescape %}
</div>

<script>
// Disable the reply button whenever the body is empty.
let submit = document.querySelector("#comment-form input[type='submit']");
let textarea = document.querySelector("#comment-form textarea");

textarea.addEventListener("input", event => {
  if (textarea.value.trim() === "") {
    submit.disabled = true;
  } else {
    submit.disabled = false;
  }
});
</script>
{% endblock %}

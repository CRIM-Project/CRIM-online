{% extends "base.html" %}

{% block title %}
<title>CRIM | {% if query %}Search results{% else %}Search{% endif %}</title>
{% endblock %}

{% block header %}
  <script type="text/javascript">
    $(document).ready(function ($) {
        fetchRelationshipResults();
      $("#search-form").on({
        'submit': function(event) {
          $(':input[value="None"]', $("#search-form")).each(function(){
            $(this).attr('disabled', true);
          })
        }
      })
    });
  </script>
{% endblock %}

{% block wrap %}
  <div class="search-heading">
    <h1 class="search-title page-title">Advanced search</h1>
    <p>Returns relationships matching at least one checked item in each selected category.</p>
  </div>
  <div class="search-container content-container">
    <form id="search-form" action="/search" method="get">
      <div class="row-fluid">
        <div class="span8">
          <h3>Any field</h3>
          <input type="text" name="q" class="search-input"/>
        </div>
      </div>
      <hgroup>
        <h3><a id="observer" class="detailed-search-heading">Observer</a></h3>
      </hgroup>
      <div id="observer-search-content" class="row-fluid detailed-search-content">
        <div class="span8">
          (Matches <em>any</em>)
          {% include "search/blocks/observer.html" %}
        </div>
      </div>
      <h3><a id="model" class="detailed-search-heading">Model</a></h3>
      <div id="model-search-content" class="row-fluid detailed-search-content">
        <div class="span4">
          {% include "search/blocks/model_composer.html" %}
        </div>
        <div class="span4">
          {% include "search/blocks/model_genre.html" %}
        </div>
      </div>
      <h3><a id="derivative" class="detailed-search-heading">Derivative</a></h3>
      <div id="derivative-search-content" class="row-fluid detailed-search-content">
        <div class="span4">
          {% include "search/blocks/derivative_composer.html" %}
        </div>
        <div class="span4">
          {% include "search/blocks/derivative_genre.html" %}
        </div>
      </div>
      <hgroup>
        <h3><a id="relationship-type" class="detailed-search-heading">Relationship type</a></h3>
      </hgroup>
      <div id="relationship-type-search-content" class="row-fluid detailed-search-content">
        <div class="span2">{% include "search/blocks/rt_q.html" %}</div>
        <div class="span3">{% include "search/blocks/rt_tm.html" %}</div>
        <div class="span3">{% include "search/blocks/rt_tnm.html" %}</div>
        <div class="span2">{% include "search/blocks/rt_misc.html" %}</div>
      </div>
      <h3><a id="model-musical-type" class="detailed-search-heading">Model musical type</a></h3>
      <div id="model-musical-type-search-content" class="detailed-search-content">
        <div class="row-fluid">
          <div class="span3">{% include "search/blocks/model_mt_cf.html" %}</div>
          <div class="span3">{% include "search/blocks/model_mt_sog.html" %}</div>
          <div class="span3">{% include "search/blocks/model_mt_csog.html" %}</div>
          <div class="span3">{% include "search/blocks/model_mt_cd.html" %}</div>
        </div>
        <div class="row-fluid">
          <div class="span3">{% include "search/blocks/model_mt_fg.html" %}</div>
          <div class="span3">{% include "search/blocks/model_mt_pe.html" %}</div>
          <div class="span3">{% include "search/blocks/model_mt_id.html" %}</div>
          <div class="span3">{% include "search/blocks/model_mt_nid.html" %}</div>
        </div>
        <div class="row-fluid">
          <div class="span3">{% include "search/blocks/model_mt_hr.html" %}</div>
          <div class="span3">{% include "search/blocks/model_mt_cad.html" %}</div>
          <div class="span3">{% include "search/blocks/model_mt_int.html" %}</div>
          <div class="span3">{% include "search/blocks/model_mt_fp.html" %}</div>
        </div>
      </div>
      <h3><a id="derivative-musical-type" class="detailed-search-heading">Derivative musical type</a></h3>
      <div id="derivative-musical-type-search-content" class="detailed-search-content">
        <div class="row-fluid">
          <div class="span3">{% include "search/blocks/derivative_mt_cf.html" %}</div>
          <div class="span3">{% include "search/blocks/derivative_mt_sog.html" %}</div>
          <div class="span3">{% include "search/blocks/derivative_mt_csog.html" %}</div>
          <div class="span3">{% include "search/blocks/derivative_mt_cd.html" %}</div>
        </div>
        <div class="row-fluid">
          <div class="span3">{% include "search/blocks/derivative_mt_fg.html" %}</div>
          <div class="span3">{% include "search/blocks/derivative_mt_pe.html" %}</div>
          <div class="span3">{% include "search/blocks/derivative_mt_id.html" %}</div>
          <div class="span3">{% include "search/blocks/derivative_mt_nid.html" %}</div>
        </div>
        <div class="row-fluid">
          <div class="span3">{% include "search/blocks/derivative_mt_hr.html" %}</div>
          <div class="span3">{% include "search/blocks/derivative_mt_cad.html" %}</div>
          <div class="span3">{% include "search/blocks/derivative_mt_int.html" %}</div>
          <div class="span3">{% include "search/blocks/derivative_mt_fp.html" %}</div>
        </div>
      </div>
      <div class="search-buttons">
        <button id="search-submit" type="submit" class="btn btn-large btn-inverse">Search</button>
        <button id="search-reset" type="reset" class="btn btn-large">Clear</button>
      </div>
    </form>
  </div>
  
  <style>
  .detailed-search-content  {
     display: none;
  }
  </style>

  <script>
  $(function(){
     $('.detailed-search-heading').click(function(){
         var contentId = $(this).attr('id');
         $('#' + contentId + '-search-content').toggle(100);
      });
  });
  </script>
  
{% endblock %}
